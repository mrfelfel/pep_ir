# اتصال به درگاه پرداخت بانک پاسارگاد در nodejs

این بسته جهت آسان سازی کار برنامه نویسان در ارتباط با درگاه پرداخت بانک پاسارگاد ایجاد شده است

# روش استفاده 
ابتدا یک شی جدید ایجاد کنید
```js
   const Pep = require("pep_ir");
   const pep = new Pep({
    pk: "<RSAKeyValue>......</RSAKeyValue>", // replace with your xml private key from (my.pep.co.ir panel)
    terminal: "YOUR_TERMINAL_CODE",
    merchant: "YOUR_MERCHANT_CODE"
})
```

# پرداخت
جهت انجام عملیات پرداخت میتوانید از تابع زیر استفاده کنید

```js
await pep.pay({
    Amount:1000,
    CallbackURL:"YOUR_WEBSITE_LINK"
})
```
> توصیه های برنامه نویس
دقت کنید باید خروجی را در صورت موفقیت آمیز بودن در دیتابیس خود ذخیره کنید
که در مراحل بعد بتوانید در توابع تایید وضعیت تراکنش از آنها استفاده کرده 
و همچنین از عملیات داپلیکیت شدن پرداخت جلوگیری کنید :)

# تایید

وب سایت پپ پس از انجام تراکنش، مشتری را به آدرسی که در کالبک یو آر ال تعریف کردید بر میگرداند و به صورت
کوئری مقادیر زیر را به آن پاس میدهد

```js
 InvoiceNumber // در فیلد iN
 InvoiceDate // در فیلد iD
 TransactionReferenceID // در فیلد tref
```
بعد از موفق بودن پرداخت باید آن را تایید کنید در غیر این صورت پول به حساب پرداخت کننده برگشت داده میشود


```js
await pep.verify({
    InvoiceNumber:"INVOICE_NUMBER",
    InvoiceDate:"INVOICE_DATE",
    Amount:"AMOUNT"
})
```
> سخنی از برنامه نویس
> حالا اگه میپرسید مبلغ رو از کجا بیاریم اگه یادتون باشه گفتم که در دیتابیس ذخیره کنید که بعدا به دردتون میخوره


# با تشکر
خوب اسم من دکتر فلفله اگه خواستید ازم تشکر کنید ...
میتونید منو مهمون یه شام یا هرچیزی بکنید
اسم حقیقی من هم محمد جواد یاحقی هست ولی اصلا دوست ندارم به این اسم صدا بشم :)
[ تشکر از من ] : https://zarinp.al/drfelfel